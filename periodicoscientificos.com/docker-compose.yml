version: '3.6'
services:
  db:
    image: 'mariadb:10.2'
    env_file: .env
    container_name: '${COMPOSE_PROJECT_NAME:-ojs}_db'
    restart: always
    volumes:
      - 'db_data:/var/lib/mysql'
    environment:
      MYSQL_ROOT_PASSWORD: '${MYSQL_ROOT_PASSWORD:-root}'
      MYSQL_DATABASE: '${MYSQL_DATABASE:-ojs}'
      MYSQL_USER: '${MYSQL_USER:-ojs}'
      MYSQL_PASSWORD: '${MYSQL_PASSWORD:-ojs}'
  ojs:
    image: 'lucasdiedrich/ojs:master'
    env_file: .env
    container_name: '${COMPOSE_PROJECT_NAME:-pkp}_ojs'
    restart: always
    ports:
      - '8085:80'
      - '8086:443'
    volumes:
      - '/etc/localtime:/etc/localtime'
      - './files/private:/var/www/files'
      - './files/public:/var/www/html/public'
      - './files/logs:/var/log/apache2'
      - './ojs:/var/www/html'
      - './config/php.custom.ini:/usr/local/etc/php/conf.d/custom.ini'
    environment:
      SERVERNAME: periodicoscientificos.com
      VIRTUAL_HOST: periodicoscientificos.com
    depends_on:
      - db
networks:
  default:
    external:
      name: nginx-proxy
volumes:
  db_data: null
